ESM Purity Scan - CommonJS Pattern Detection
============================================

Scan Date: $(date)
Backend Directory: ssb-backend/

1. CommonJS require() patterns:
================================
File: ssb-backend\src\test_firebase.js
Line: 7
Pattern: require(
Match: const serviceAccount = require('./config/serviceAccountKey.json');
Suggestion: Convert to import statement

File: ssb-backend\src\app.js
Line: 12
Pattern: require(
Match: // const errorHandler = require('./middlewares/errorHandler');
Suggestion: Commented out - OK

File: ssb-backend\src\routes\api\bus.js
Line: 239
Pattern: require(
Match: const express = require('express');
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 240
Pattern: require(
Match: const http = require('http');
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 241
Pattern: require(
Match: const { Server } = require("socket.io"); // Import Server tá»« socket.io
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 242
Pattern: require(
Match: const cors = require('cors');
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 277
Pattern: require(
Match: const busRoutes = require('./routes/api/buses');
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 278
Pattern: require(
Match: const scheduleRoutes = require('./routes/api/schedules');
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 308
Pattern: require(
Match: const express = require('express');
Suggestion: Convert to import statement

File: ssb-backend\src\routes\api\bus.js
Line: 343
Pattern: require(
Match: const express = require('express');
Suggestion: Convert to import statement

2. module.exports patterns:
===========================
File: ssb-backend\src\routes\api\bus.js
Line: 211
Pattern: module.exports
Match: module.exports = router;
Suggestion: Convert to export default

File: ssb-backend\src\routes\api\bus.js
Line: 337
Pattern: module.exports
Match: module.exports = router;
Suggestion: Convert to export default

3. exports. patterns:
====================
No matches found - PASS

4. .cjs files:
==============
No .cjs files found - PASS

5. __dirname/__filename usage:
==============================
File: ssb-backend\dist\config\env.js
Line: 4-6
Pattern: __dirname|__filename
Match: const __filename = fileURLToPath(import.meta.url);
       const __dirname = path.dirname(__filename);
       dotenv.config({ path: path.join(__dirname, '../../.env') });
Suggestion: ACCEPTED - Properly using import.meta.url

File: ssb-backend\src\config\env.ts
Line: 5-10
Pattern: __dirname|__filename
Match: // Get __dirname equivalent in ESM
       const __filename = fileURLToPath(import.meta.url);
       const __dirname = path.dirname(__filename);
       dotenv.config({ path: path.join(__dirname, '../../.env') });
Suggestion: ACCEPTED - Properly using import.meta.url

6. Jest patterns:
================
No jest. patterns found - PASS

7. require.main patterns:
========================
No require.main patterns found - PASS

8. exports = patterns:
======================
File: ssb-backend\src\routes\api\bus.js
Line: 211
Pattern: exports\s*=\s*
Match: module.exports = router;
Suggestion: Convert to export default

File: ssb-backend\src\routes\api\bus.js
Line: 337
Pattern: exports\s*=\s*
Match: module.exports = router;
Suggestion: Convert to export default

SUMMARY:
========
- Found 10 require() calls (9 active, 1 commented)
- Found 2 module.exports calls
- Found 2 exports = patterns (same as module.exports)
- No .cjs files
- __dirname/__filename properly handled with import.meta.url
- No Jest or require.main patterns

VIOLATIONS FOUND:
================
1. ssb-backend/src/test_firebase.js - Line 7: require() call
2. ssb-backend/src/routes/api/bus.js - Multiple require() and module.exports calls
3. ssb-backend/src/app.js - Line 12: Commented require() (OK)

RECOMMENDATION: Convert remaining CommonJS patterns to ESM
